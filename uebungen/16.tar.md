# Übungen zu `tar` unter Linux

>[!NOTE]
> Das Kommando `tar` ist schon ziemlich alt und eventuell ein wenig "sperrig" oder "eigen". Die Kurzoptionen scheinen einfach nicht zu den Langoptionen zu passen. Das hat historische Gründe. Nehmt es vielleicht einfach hin...
> Versucht die folgenden Übungen trotzdem zuerst mit Hilfe der Manpage zu lösen. Nutzt dafür die Suche (`/`), sucht nach Schlüsselwörtern oder überlegt euch, wie eine Option in der Langschreibweise heißen könnte. Falls die Manpage auf Englisch ist, überlegt euch den englischen Begriff für das Gesuchte.

Netter Link in diesem Zusammenhang: [xkcd - tar](https://xkcd.com/1168/)

## Übung 1: Einfache Archivierung
Erstelle ein Archiv aus mehreren Dateien.

1. Erstelle drei Dateien: `file1.txt`, `file2.txt` und `file3.txt`.
2. Erstelle ein Archiv `backup.tar`, das diese drei Dateien enthält.
3. Überprüfe (z.B. mit `ls` oder auch `cat`), ob das Archiv erfolgreich erstellt wurde.

## Übung 2: Archivinhalt anzeigen
Zeige den Inhalt eines bestehenden `tar`-Archivs an. Verwende hierzu eine Option von `tar` und nicht z.B. `cat`.

1. Verwende das zuvor erstellte `backup.tar`.
2. Liste die enthaltenen Dateien auf, bzw. schaue dir den Inhalt des Archivs an.
3. Gibt es auch eine Möglichkeit, dir zusätzlich die von `tar` zu den Dateien gespeicherten *Metainformationen* anzeigen zu lassen?
4. Kannst du auch prüfen, ob nur eine bestimmte Datei im Archiv ist bzw. dir diese Datei inklusive der Metainformationen anzeigen lassen?

## Übung 3: Position der Option -f

Erkläre, warum folgende Kommando funktioneren:
```bash
tar -tf backup.tar
tar -tvf backup.tar
```
Und warum folgende Kommandos **nicht** funktionieren:
```bash
tar -ft backup.tar
tar -ftv backup.tar
tar -vft backup.tar
```
Die Reihenfolge der Optionen war doch immer egal oder nicht? `ls -la` funktioniert doch genauso wie `ls -al`...? 

- Warum ist das hier nicht der Fall? 
- Liegt das an `tar`? Oder kannst du dazu eine Regel erkennen? Kann das also auch bei andern Kommandos passieren?

Teste abschließend doch nochmal kurz folgendes Kommando:
```bash
tar ft archiv.tar
```
Na prima...

:hushed: :confounded: :cry: :boom:

## Übung 4: Archiv erweitern
Füge eine Datei zu einem bestehenden Archiv hinzu.

1. Erstelle eine neue Datei `file4.txt`.
2. Füge diese Datei zum bestehenden `backup.tar`-Archiv hinzu.
3. Überprüfe, ob die Datei nun zusätzlich im Archiv enthalten ist.
4. Gibt es hierfür mehr als eine Möglichkeit?

## Übung 5: Archiv extrahieren
Entpacke ein `tar`-Archiv.

1. Lösche die ursprünglichen `file1.txt`, `file2.txt`, `file3.txt` und `file4.txt`.
2. Extrahiere alle Dateien aus `backup.tar`.
3. Prüfe, ob die Dateien korrekt wiederhergestellt wurden.

**Zusatz:** Wenn du bei Übung 4 eine bereits im Archiv enthaltene Datei erneut hinzugefügt hast, wird diese ja ans Ende des Archivs angehangen. Welche Datei wird in diesem Fall denn extrahiert? Gibt es auch eine Möglichkeit, die andere Datei zu extrahieren bzw. eine davon gezielt anzusprechen?

## Übung 6: Einzelne Datei extrahieren
Extrahiere nur eine bestimmte Datei aus einem `tar`-Archiv.

1. Lösche nun die Dateien `file1.txt`, `file2.txt`, `file3.txt` und `file4.txt`.
2. Extrahiere nur `file2.txt` aus `backup.tar`.
3. Stelle sicher, dass die anderen Dateien nicht erneut extrahiert wurden.

## Übung 7: Archiv erstellen - relative und absolute Pfadangaben
Erstelle ein Archiv, das ein ganzes Verzeichnis enthält. Es soll also ein gesamtes Verzeichnis und nicht nur alle sich im Verzeichnis befindenden Dateien zum Archiv hinzugefügt werden.

1. Erstelle ein Verzeichnis `mydir` und darin einige Dateien oder nutze ein bestehendes Verzeichnis mit Inhalt.
2. Erstelle ein `tar`-Archiv, das das gesamte Verzeichnis `mydir` enthält. Verwende einen **relativen** Pfad zu diesem Verzeichnis. Nenne das Archiv z.B. `mydir-rel-path.tar`.
2. Erstelle ein **weiteres** `tar`-Archiv, das das gesamte Verzeichnis `mydir` enthält. Verwende diesmal einen **absoluten** Pfad zu diesem Verzeichnis. Nenne das Archiv z.B. `mydir-abs-path.tar`.
3. Überprüfe den Inhalt der beiden Archive und schaue dir die Pfadangaben zu den Dateien an. Fällt dir hier etwas darüber auf, inwieweit sich `tar` unterschiedlich verhält, je nachdem ob wir einen relativen oder absoluten Pfad zu einer Datei bzw. einem Verzeichnis angeben?
4. Gab es vielleicht "Fehlermeldungen" von `tar` beim Erstellen des Archivs mit den absoluten Pfaden? Irgendwas mit `Removing leading /` oder so? Setze diese Meldung in Kontext zu den Pfadangaben die du siehst, wenn du dir den Inhalt dieses Archivs anzeigen lässt.
5. Was schliesst du daraus über die Arbeitsweise von `tar` bezüglich Pfadangaben? 
6. Warum macht `tar` das so? Denke hierbei an den Einsatz von `tar` als Backup-Tool.
7. Vielleicht wird der Umstand noch deutlicher, wenn du nur eine *einzelne* Datei aus dem Archiv mit den absoluten Pfaden extrahierst und dir anschliessend die Verzeichnisstruktur anschaust.

## Übung 8: Differentielles Archiv erstellen
Erstelle ein Archiv von Dateien, die seit einer bestimmten Zeit geändert wurden. Nutze dafür vielleicht das Archiv aus Übung 6.

1. Erstelle einige Dateien und ändere einige davon nach einer gewissen Zeit.
2. Erstelle ein `tar`-Archiv, das nur die geänderten Dateien enthält.
3. Überprüfe den Archivinhalt.

## Übung 9: Beschädigtes Archiv überprüfen
Überprüfe ein `tar`-Archiv auf Fehler.

1. Erstelle ein `tar`-Archiv und simuliere eine Beschädigung, indem du einige Bytes entfernst:
```sh
truncate -s -10 backup.tar
```
2. Versuche nun, es auf Fehler zu überprüfen, bzw. es zu *testen*.

## Übung 10: Archiv ohne bestimmte Dateien erstellen
Erstelle ein Archiv, das bestimmte Dateien oder Dateitypen nicht enthält. 

Es gibt Situationen, in denen wir ein Archiv aus vielen Dateien oder Verzeichnissen erstellen wollen, wir möchten bestimmte Dateien aber nicht darin haben, z.B. Log-Dateien, Cache-Dateien oder so. Dies wollen wir mit dieser Übung simulieren.

1. Erstelle verschiedene Dateitypen in einem Verzeichnis, also Dateien mit Endungen wie z.B. `.txt`, `.log`, `.cfg`, `.pdf` etc.
2. Erstelle nun ein `tar`-Archiv des gesamten Verzeichnisses, sorge aber dafür, dass `.log`-Dateien nicht darin enthalten sind.
3. Überprüfe den Inhalt des Archivs, um sicherzustellen, dass `.log`-Dateien fehlen.

## Übung 11: Archiv an einem bestimmten Ort extrahieren
Extrahiere das in der vorigen Übung erstellte Archiv in einem bestimmten Verzeichnis, ohne vorher mit `cd` dorthin zu navigieren.

1. Erstelle ein Verzeichnis in deinem Heimatverzeichnis mit dem Namen `some-dir-for-tar`.
2. Wechsel **nicht** dort hinein, sondern extrahiere den Inhalt des Archivs in dieses Verzeichnis von dort aus, wo du dich gerade befindest, also von irgendeinem anderen Verzeichnis aus.
3. Überprüfe, ob alles wie gewünscht funktioniert hat.
